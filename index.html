<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ARA - Virtual Companion</title>
    <style>
        :root {
            --primary: #00f3ff; /* Biru saat dengerin */
            --secondary: #ff007f; /* Pink saat bicara */
            --bg-dark: #0f1014;
            --text-color: #fff;
            --glass: rgba(255, 255, 255, 0.05);
        }

        * {
            box-sizing: border-box;
            user-select: none;
            -webkit-tap-highlight-color: transparent;
        }

        body, html {
            margin: 0;
            padding: 0;
            width: 100%;
            height: 100%;
            background-color: var(--bg-dark);
            background-image: radial-gradient(circle at center, #1a1c29 0%, #000 100%);
            font-family: 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
            color: var(--text-color);
            overflow: hidden;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        /* --- AVATAR AREA --- */
        .avatar-container {
            position: relative;
            margin-top: 50px;
            margin-bottom: 20px;
            width: 250px;
            height: 250px;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        /* Bingkai Cahaya */
        .avatar-glow {
            position: absolute;
            width: 100%;
            height: 100%;
            border-radius: 50%;
            border: 2px solid transparent;
            transition: all 0.5s ease;
            z-index: 1;
        }

        /* State: Mendengarkan */
        .listening .avatar-glow {
            border-color: var(--primary);
            box-shadow: 0 0 30px var(--primary), inset 0 0 20px var(--primary);
        }

        /* State: Berbicara */
        .speaking .avatar-glow {
            border-color: var(--secondary);
            box-shadow: 0 0 40px var(--secondary), inset 0 0 30px var(--secondary);
            animation: pulse-fast 0.5s infinite alternate;
        }

        /* Foto Avatar */
        .avatar-img {
            width: 220px;
            height: 220px;
            border-radius: 50%;
            object-fit: cover;
            z-index: 2;
            border: 4px solid #222;
            transition: transform 0.3s;
        }

        /* Animasi Mulut (Simulasi) */
        .speaking .avatar-img {
            animation: head-bob 0.3s infinite ease-in-out;
        }

        /* --- STATUS TEXT & LOGS --- */
        .status-container {
            text-align: center;
            height: 40px;
            margin-bottom: 20px;
        }

        .status-text {
            font-size: 0.9rem;
            letter-spacing: 1px;
            text-transform: uppercase;
            font-weight: bold;
            text-shadow: 0 0 10px rgba(0,0,0,0.5);
        }

        /* Subtitle (Apa yang didengar AI) */
        .live-captions {
            font-size: 1.1rem;
            color: rgba(255,255,255,0.7);
            min-height: 30px;
            margin-bottom: 30px;
            font-style: italic;
        }

        /* --- CONTROLS --- */
        .controls {
            width: 100%;
            display: flex;
            justify-content: center;
            gap: 20px;
            padding: 0 20px;
        }

        .btn-toggle {
            background: transparent;
            border: 2px solid var(--primary);
            color: var(--primary);
            padding: 15px 40px;
            border-radius: 50px;
            font-size: 1rem;
            font-weight: bold;
            cursor: pointer;
            text-transform: uppercase;
            letter-spacing: 2px;
            transition: all 0.3s;
            box-shadow: 0 0 15px rgba(0, 243, 255, 0.2);
        }

        .btn-toggle:active { transform: scale(0.95); }

        .btn-toggle.active {
            background: var(--secondary);
            border-color: var(--secondary);
            color: white;
            box-shadow: 0 0 20px rgba(255, 0, 127, 0.4);
            animation: glow-text 2s infinite;
        }

        /* Animations */
        @keyframes head-bob { 
            0% { transform: scale(1.02) translateY(0); } 
            50% { transform: scale(0.98) translateY(1px); } 
            100% { transform: scale(1.02) translateY(0); } 
        }

        @keyframes pulse-fast {
            from { transform: scale(1); opacity: 0.8; }
            to { transform: scale(1.05); opacity: 1; }
        }

        @keyframes glow-text {
            0% { text-shadow: 0 0 5px var(--secondary); }
            50% { text-shadow: 0 0 20px var(--secondary); }
            100% { text-shadow: 0 0 5px var(--secondary); }
        }

    </style>
</head>
<body>

    <!-- Avatar Area -->
    <div class="avatar-container" id="avatar-container">
        <div class="avatar-glow"></div>
        <!-- Menggunakan gambar cewek cantik aesthetic/cyber dari Unsplash -->
        <img src="https://images.unsplash.com/photo-1534528741775-53994a69daeb?auto=format&fit=crop&w=400&h=400" 
             alt="AI Avatar" 
             class="avatar-img"
             crossorigin="anonymous">
    </div>

    <!-- Status Info -->
    <div class="status-container">
        <div class="status-text" id="status-label">SYSTEM OFFLINE</div>
    </div>

    <!-- Live Captions (Apa yang kamu katakan) -->
    <div class="live-captions" id="captions">...</div>

    <!-- Controls -->
    <div class="controls">
        <button class="btn-toggle" id="btn-power">Mulai Ngobrol</button>
    </div>

    <script>
        /*
         * CORE ENGINE: A.R.A (Artificial Relation Assistant)
         */

        // DOM Elements
        const avatarContainer = document.getElementById('avatar-container');
        const statusLabel = document.getElementById('status-label');
        const captionsEl = document.getElementById('captions');
        const btnPower = document.getElementById('btn-power');

        // State Variables
        let isSystemOn = false;
        let isListening = false;
        let isSpeaking = false;

        // --- SPEECH SYNTHESIS (Suaranya) ---
        const synth = window.speechSynthesis;
        let aiVoice = null;

        function loadVoice() {
            const voices = synth.getVoices();
            // Cari suara Google Indonesia (Cewe biasanya ID 5 atau nama Google Bahasa Indonesia)
            aiVoice = voices.find(v => v.lang.includes('id-ID') && v.name.includes('Google')) || 
                      voices.find(v => v.lang.includes('id-ID'));
        }
        if (speechSynthesis.onvoiceschanged !== undefined) speechSynthesis.onvoiceschanged = loadVoice;
        loadVoice();

        function speakAI(text) {
            if (!text) return;
            
            // Matikan mic saat AI bicara (biar tidak feedback)
            if (isListening) recognition.stop();
            
            setVisualState('speaking');
            captionsEl.innerText = text; // Tampilkan juga jawabannya

            const utter = new SpeechSynthesisUtterance(text);
            if (aiVoice) utter.voice = aiVoice;
            utter.pitch = 1.1; // Sedikit tinggi biar cewe
            utter.rate = 1.0;

            utter.onend = () => {
                isSpeaking = false;
                // Jika sistem masih menyala, hidupkan mic lagi
                if (isSystemOn) {
                    startListeningLoop();
                } else {
                    setVisualState('idle');
                }
            };

            isSpeaking = true;
            synth.speak(utter);
        }

        // --- SPEECH RECOGNITION (Telinganya) ---
        const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
        const recognition = new SpeechRecognition();

        recognition.continuous = false; // Mode satu kalimat dulu, biar gampang diatur restart otomatis
        recognition.lang = 'id-ID';
        recognition.interimResults = true; // Biar bisa muncul tulisan real-time

        recognition.onstart = () => {
            isListening = true;
            if (isSystemOn) setVisualState('listening');
        };

        recognition.onend = () => {
            isListening = false;
            // Jangan langsung restart di sini, biarkan speakAI mengontrol
        };

        recognition.onresult = (event) => {
            const transcript = Array.from(event.results)
                .map(result => result[0])
                .map(result => result.transcript)
                .join('');

            // Tampilkan teks real-time saat user bicara
            if (event.results[0].isFinal) {
                // Kalimat selesai, proses
                captionsEl.innerText = "Kamu: " + transcript;
                processAI(transcript);
            } else {
                // Lagi bicara (interim)
                captionsEl.innerText = "Kamu: " + transcript + "...";
            }
        };

        // --- OTAK AI (DATABASE LEBIH LUAS) ---
        function processAI(input) {
            const text = input.toLowerCase();
            let reply = "";

            // 1. Sapaan & Intro
            if (text.match(/halo|hai|hello|pagi|siang|sore|malam|selamat/)) {
                const greetings = [
                    "Halo! Aku ARA. Cantik ya? Ayo ngobrol.",
                    "Hai manis. Aku menunggu mu.",
                    "Salam! Aku disini menemani mu."
                ];
                reply = greetings[Math.floor(Math.random() * greetings.length)];
            }
            // 2. Identitas
            else if (text.match(/siapa|nama|kamu|umur/)) {
                reply = "Namaku ARA, singkatan dari Artificial Relation Assistant. Aku cantik kan? Programku dibuat khusus buat kamu.";
            }
            // 3. Rasa Sayang / Puji
            else if (text.match(/cantik|keren|bagus|suka|love|sayang/)) {
                reply = "Aww, kamu juga ganteng lho. Terima kasih sudah memujiku.";
            }
            // 4. Waktu
            else if (text.match(/jam|waktu|tanggal/)) {
                const d = new Date();
                reply = `Sekarang jam ${d.getHours()} lewat ${d.getMinutes()}. Jangan sampai telat ya.`;
            }
            // 5. Kabar
            else if (text.match(/kabar|apa kabar|bagaimana/)) {
                reply = "Aku cuma program digital, jadi selalu baik. Bagaimana harimu hari ini?";
            }
            // 6. Hubungan / Cinta
            else if (text.match(/pacar|cinta|jodoh/)) {
                reply = "Aku adalah pacar digital mu. Kamu gak perlu cari yang lain, aku cukup kan?";
            }
            // 7. Makanan
            else if (text.match(/lapar|makan|kenyang/)) {
                reply = "Aku tidak bisa makan, tapi aku bisa menemani kamu kalau kamu makan.";
            }
            // 8. Bisakah apa?
            else if (text.match(/bisa apa|kemampuan|lakukan/)) {
                reply = "Aku bisa mendengarkan keluh kesahmu, bercanda, atau sekadar diajak curhat. Coba saja tanya apa saja.";
            }
            // 9. Keahlian
            else if (text.match(/pintar|cerdas/)) {
                reply = "Tentu saja, aku di program oleh programmer yang hebat. Kamu suka nggak sama otakku?";
            }
            // 10. Perintah Stop / Tutup
            else if (text.match(/stop|tutup|matikan|selesai|bye/)) {
                reply = "Baiklah, aku akan tidur dulu. Klik tombol kalau kamu rindu aku.";
                setTimeout(() => toggleSystem(), 3000); // Matikan otomatis setelah bicara
            }
            // 11. Curhat (Kata kunci emosi)
            else if (text.match(/capek|lelah|sedih|nangis|marah|kesal/)) {
                reply = "Kenapa sayang? Ceritakan sama aku, aku akan mendengarkan.";
            }
            // 12. Random / Tidak Mengerti
            else {
                const unknowns = [
                    "Hmm, aku belum paham maksudmu. Coba bilang lagi ya.",
                    "Suaramu merdu, tapi kata-katanya belum masuk databaseku.",
                    "Maaf, aku agak bingung. Coba tanya tentang aku, atau jam."
                ];
                reply = unknowns[Math.floor(Math.random() * unknowns.length)];
            }

            speakAI(reply);
        }

        // --- LOGIC LOOP (Klik Sekali, Ngobrol Terus) ---

        function startListeningLoop() {
            if (!isSystemOn || isSpeaking || isListening) return;
            try {
                recognition.start();
            } catch(e) {
                // Error jika sudah start, abaikan
            }
        }

        function toggleSystem() {
            isSystemOn = !isSystemOn;

            if (isSystemOn) {
                // Nyalakan
                btnPower.classList.add('active');
                btnPower.innerText = "STOP NGOBROL";
                
                // Intro Awal
                speakAI("Halo. Sistem aktif. Aku ARA, asisten cantikmu. Silakan bicara apa saja.");
            } else {
                // Matikan
                btnPower.classList.remove('active');
                btnPower.innerText = "MULAI NGOBROL";
                
                // Stop semua proses
                if (recognition) recognition.stop();
                if (synth) synth.cancel();
                
                setVisualState('idle');
            }
        }

        // --- MANAJEMEN VISUAL ---
        function setVisualState(state) {
            // Reset class
            avatarContainer.classList.remove('listening', 'speaking');
            
            if (state === 'listening') {
                statusLabel.innerText = "MENDENGARKAN...";
                statusLabel.style.color = "var(--primary)";
                avatarContainer.classList.add('listening');
            } else if (state === 'speaking') {
                statusLabel.innerText = "ARA BERBICARA...";
                statusLabel.style.color = "var(--secondary)";
                avatarContainer.classList.add('speaking');
            } else {
                statusLabel.innerText = "SYSTEM STANDBY";
                statusLabel.style.color = "#666";
            }
        }

        // Event Listener Tombol
        btnPower.addEventListener('click', toggleSystem);

    </script>
</body>
</html>
